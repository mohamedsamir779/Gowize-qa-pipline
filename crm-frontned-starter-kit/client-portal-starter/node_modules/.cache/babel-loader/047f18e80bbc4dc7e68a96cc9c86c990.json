{"ast":null,"code":"import{takeEvery,fork,put,all,call,takeLatest}from\"redux-saga/effects\";import{fetchProfileAPI,editProfileAPI,submitProfileAPI,convertProfileAPI,uploadPorfileAvatarAPI,editProfileSettingsAPI}from\"../../../../apis/profile\";// Login Redux States\nimport{EDIT_PROFILE,FETCH_PROFILE_START,SUBMIT_IND_PROFILE_START,CONVERT_PROFILE_REQUESTED,UPLOAD_PROFILE_AVATAR_START,DELETE_PROFILE_AVATAR_START,UPDATE_PROFILE_SETTINGS}from\"./actionTypes\";import{profileSuccess,profileError,editProfileSuccess,submitIndProfileDone,convertProfileSuccess,convertProfileFail,uploadProfileAvatarEnd,deleteAvatarImageEnd,updateProfileSettingsSuccess,updateProfileSettingsFail}from\"./actions\";import{showErrorNotification,showSuccessNotification}from\"../../notifications/actions\";import{logoutUser}from\"../login/actions\";import{CUSTOMER_SUB_PORTALS}from\"common/constants\";import{switchSubPortal}from\"store/actions\";function editProfile(_ref){let{payload:{user}}=_ref;return function*(){try{const result=yield call(editProfileAPI,user);yield put(editProfileSuccess(result));}catch(error){yield put(profileError(error.message));}}();}function fetchProfile(_ref2){let{payload}=_ref2;return function*(){try{const data=yield call(fetchProfileAPI);if(data.fx.isIb&&!data.fx.isClient)yield put(switchSubPortal(CUSTOMER_SUB_PORTALS.IB));yield put(profileSuccess(data));}catch(error){yield put(profileError(error.message));yield put(logoutUser(payload.history));}}();}function submmitIndProfile(_ref3){let{payload}=_ref3;return function*(){try{const data=yield call(submitProfileAPI,payload);yield put(submitIndProfileDone({stages:data}));yield put(showSuccessNotification(\"Profile completed successfully\"));}catch(error){yield put(submitIndProfileDone({error:error.message}));}}();}function*convertProfile(){try{const data=yield call(convertProfileAPI);yield put(convertProfileSuccess(data));yield put(showSuccessNotification(\"Profile converted successfully, Please log in again\"));}catch(error){yield put(convertProfileFail({error:error.message}));yield put(showErrorNotification(error.message));}}function uploadProfileImage(_ref4){let{payload,callback}=_ref4;return function*(){try{const imageFile=payload;const formData=new FormData();formData.append(\"type\",\"ProfileImage\");formData.append(\"images\",imageFile);const data=yield call(uploadPorfileAvatarAPI,formData);yield put(uploadProfileAvatarEnd({success:data}));yield put(showSuccessNotification(\"Profile avatar uploaded successfully\"));if(callback){callback();}}catch(error){yield put(uploadProfileAvatarEnd({error:error.message}));yield put(showErrorNotification(error.message));}}();}function deleteAvatarImage(_ref5){let{callback}=_ref5;return function*(){try{const data=yield call(uploadPorfileAvatarAPI,{avatarImage:\"\"});yield put(deleteAvatarImageEnd({success:data}));yield put(showSuccessNotification(\"Profile avatar deleted successfully\"));if(callback){callback();}}catch(error){yield put(deleteAvatarImageEnd({error:error.message}));yield put(showErrorNotification(error.message));}}();}function updateProfileSettings(_ref6){let{payload}=_ref6;return function*(){try{const data=yield call(editProfileSettingsAPI,payload);console.log(\"testing\",data);console.log(\"testing\",payload);yield put(updateProfileSettingsSuccess(payload));yield put(showSuccessNotification(\"Profile settings updated successfully\"));}catch(error){yield put(updateProfileSettingsFail({error:error.message}));yield put(showErrorNotification(error.message));}}();}export function*watchProfile(){yield takeEvery(EDIT_PROFILE,editProfile);yield takeEvery(FETCH_PROFILE_START,fetchProfile);yield takeEvery(SUBMIT_IND_PROFILE_START,submmitIndProfile);yield takeEvery(CONVERT_PROFILE_REQUESTED,convertProfile);yield takeLatest(UPLOAD_PROFILE_AVATAR_START,uploadProfileImage);yield takeLatest(DELETE_PROFILE_AVATAR_START,deleteAvatarImage);yield takeLatest(UPDATE_PROFILE_SETTINGS,updateProfileSettings);}function*ProfileSaga(){yield all([fork(watchProfile)]);}export default ProfileSaga;","map":{"version":3,"names":["takeEvery","fork","put","all","call","takeLatest","fetchProfileAPI","editProfileAPI","submitProfileAPI","convertProfileAPI","uploadPorfileAvatarAPI","editProfileSettingsAPI","EDIT_PROFILE","FETCH_PROFILE_START","SUBMIT_IND_PROFILE_START","CONVERT_PROFILE_REQUESTED","UPLOAD_PROFILE_AVATAR_START","DELETE_PROFILE_AVATAR_START","UPDATE_PROFILE_SETTINGS","profileSuccess","profileError","editProfileSuccess","submitIndProfileDone","convertProfileSuccess","convertProfileFail","uploadProfileAvatarEnd","deleteAvatarImageEnd","updateProfileSettingsSuccess","updateProfileSettingsFail","showErrorNotification","showSuccessNotification","logoutUser","CUSTOMER_SUB_PORTALS","switchSubPortal","editProfile","_ref","payload","user","result","error","message","fetchProfile","_ref2","data","fx","isIb","isClient","IB","history","submmitIndProfile","_ref3","stages","convertProfile","uploadProfileImage","_ref4","callback","imageFile","formData","FormData","append","success","deleteAvatarImage","_ref5","avatarImage","updateProfileSettings","_ref6","console","log","watchProfile","ProfileSaga"],"sources":["/home/ubuntu/king/portal/client-portal-starter/src/store/general/auth/profile/saga.js"],"sourcesContent":["import {\n  takeEvery, fork, put, all, call, takeLatest\n} from \"redux-saga/effects\";\nimport {\n  fetchProfileAPI,\n  editProfileAPI,\n  submitProfileAPI,\n  convertProfileAPI,\n  uploadPorfileAvatarAPI,\n  editProfileSettingsAPI\n} from \"../../../../apis/profile\";\n// Login Redux States\nimport {\n  EDIT_PROFILE,\n  FETCH_PROFILE_START,\n  SUBMIT_IND_PROFILE_START,\n\n  CONVERT_PROFILE_REQUESTED,\n  UPLOAD_PROFILE_AVATAR_START,\n  DELETE_PROFILE_AVATAR_START,\n  UPDATE_PROFILE_SETTINGS\n} from \"./actionTypes\";\nimport {\n  profileSuccess,\n  profileError,\n  editProfileSuccess,\n  submitIndProfileDone,\n\n  convertProfileSuccess,\n  convertProfileFail,\n  uploadProfileAvatarEnd,\n  deleteAvatarImageEnd,\n  updateProfileSettingsSuccess,\n  updateProfileSettingsFail\n} from \"./actions\";\nimport { showErrorNotification, showSuccessNotification } from \"../../notifications/actions\";\nimport { logoutUser } from \"../login/actions\";\nimport { CUSTOMER_SUB_PORTALS } from \"common/constants\";\nimport { switchSubPortal } from \"store/actions\";\n\nfunction* editProfile({ payload: { user } }) {\n  try {\n    const result = yield call(editProfileAPI, user);\n    yield put(editProfileSuccess(result));\n  } catch (error) {\n    yield put(profileError(error.message));\n  }\n}\n\nfunction* fetchProfile({ payload }) {\n  try {\n    const data = yield call(fetchProfileAPI);\n    if (data.fx.isIb && !data.fx.isClient) yield put(switchSubPortal(CUSTOMER_SUB_PORTALS.IB));\n    yield put(profileSuccess(data));\n  }\n  catch (error) {\n    yield put(profileError(error.message));\n    yield put(logoutUser(payload.history));\n  }\n}\n\nfunction* submmitIndProfile({ payload }) {\n  try {\n\n    const data = yield call(submitProfileAPI, payload);\n    yield put(submitIndProfileDone({ stages: data }));\n    yield put(showSuccessNotification(\"Profile completed successfully\"));\n  }\n  catch (error) {\n    yield put(submitIndProfileDone({\n      error: error.message\n    }));\n  }\n}\n\nfunction* convertProfile() {\n  try {\n    const data = yield call(convertProfileAPI);\n    yield put(convertProfileSuccess(data));\n    yield put(showSuccessNotification(\"Profile converted successfully, Please log in again\"));\n  } catch (error) {\n    yield put(convertProfileFail({ error: error.message }));\n    yield put(showErrorNotification(error.message));\n  }\n}\n\nfunction* uploadProfileImage({ payload, callback }) {\n  try {\n    const imageFile = payload;\n    const formData = new FormData();\n    formData.append(\"type\", \"ProfileImage\");\n    formData.append(\"images\", imageFile);\n\n    const data = yield call(uploadPorfileAvatarAPI, formData);\n    yield put(uploadProfileAvatarEnd({ success: data }));\n    yield put(showSuccessNotification(\"Profile avatar uploaded successfully\"));\n    if (callback) {\n      callback();\n    }\n  } catch (error) {\n    yield put(uploadProfileAvatarEnd({ error: error.message }));\n    yield put(showErrorNotification(error.message));\n  }\n}\n\nfunction* deleteAvatarImage({ callback }) {\n  try {\n    const data = yield call(uploadPorfileAvatarAPI, { avatarImage: \"\" });\n    yield put(deleteAvatarImageEnd({ success: data }));\n    yield put(showSuccessNotification(\"Profile avatar deleted successfully\"));\n    if (callback) {\n      callback();\n    }\n  } catch (error) {\n    yield put(deleteAvatarImageEnd({ error: error.message }));\n    yield put(showErrorNotification(error.message));\n  }\n}\n\nfunction* updateProfileSettings({ payload }) {\n  try {\n    const data = yield call(editProfileSettingsAPI, payload);\n    console.log(\"testing\", data);\n    console.log(\"testing\", payload);\n    yield put(updateProfileSettingsSuccess(payload));\n    yield put(showSuccessNotification(\"Profile settings updated successfully\"));\n  } catch (error) {\n    yield put(updateProfileSettingsFail({ error: error.message }));\n    yield put(showErrorNotification(error.message));\n  }\n}\n\nexport function* watchProfile() {\n  yield takeEvery(EDIT_PROFILE, editProfile);\n  yield takeEvery(FETCH_PROFILE_START, fetchProfile);\n  yield takeEvery(SUBMIT_IND_PROFILE_START, submmitIndProfile);\n  yield takeEvery(CONVERT_PROFILE_REQUESTED, convertProfile);\n  yield takeLatest(UPLOAD_PROFILE_AVATAR_START, uploadProfileImage);\n  yield takeLatest(DELETE_PROFILE_AVATAR_START, deleteAvatarImage);\n  yield takeLatest(UPDATE_PROFILE_SETTINGS, updateProfileSettings);\n}\n\nfunction* ProfileSaga() {\n  yield all([fork(watchProfile)]);\n}\n\nexport default ProfileSaga;\n"],"mappings":"AAAA,OACEA,SAAS,CAAEC,IAAI,CAAEC,GAAG,CAAEC,GAAG,CAAEC,IAAI,CAAEC,UAAU,KACtC,oBAAoB,CAC3B,OACEC,eAAe,CACfC,cAAc,CACdC,gBAAgB,CAChBC,iBAAiB,CACjBC,sBAAsB,CACtBC,sBAAsB,KACjB,0BAA0B,CACjC;AACA,OACEC,YAAY,CACZC,mBAAmB,CACnBC,wBAAwB,CAExBC,yBAAyB,CACzBC,2BAA2B,CAC3BC,2BAA2B,CAC3BC,uBAAuB,KAClB,eAAe,CACtB,OACEC,cAAc,CACdC,YAAY,CACZC,kBAAkB,CAClBC,oBAAoB,CAEpBC,qBAAqB,CACrBC,kBAAkB,CAClBC,sBAAsB,CACtBC,oBAAoB,CACpBC,4BAA4B,CAC5BC,yBAAyB,KACpB,WAAW,CAClB,OAASC,qBAAqB,CAAEC,uBAAuB,KAAQ,6BAA6B,CAC5F,OAASC,UAAU,KAAQ,kBAAkB,CAC7C,OAASC,oBAAoB,KAAQ,kBAAkB,CACvD,OAASC,eAAe,KAAQ,eAAe,CAE/C,QAAU,CAAAC,WAAWA,CAAAC,IAAA,KAAC,CAAEC,OAAO,CAAE,CAAEC,IAAK,CAAE,CAAC,CAAAF,IAAA,mBAAE,CAC3C,GAAI,CACF,KAAM,CAAAG,MAAM,CAAG,KAAM,CAAAlC,IAAI,CAACG,cAAc,CAAE8B,IAAI,CAAC,CAC/C,KAAM,CAAAnC,GAAG,CAACmB,kBAAkB,CAACiB,MAAM,CAAC,CAAC,CACvC,CAAE,MAAOC,KAAK,CAAE,CACd,KAAM,CAAArC,GAAG,CAACkB,YAAY,CAACmB,KAAK,CAACC,OAAO,CAAC,CAAC,CACxC,CACF,CAAC,IAED,QAAU,CAAAC,YAAYA,CAAAC,KAAA,KAAC,CAAEN,OAAQ,CAAC,CAAAM,KAAA,mBAAE,CAClC,GAAI,CACF,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAvC,IAAI,CAACE,eAAe,CAAC,CACxC,GAAIqC,IAAI,CAACC,EAAE,CAACC,IAAI,EAAI,CAACF,IAAI,CAACC,EAAE,CAACE,QAAQ,CAAE,KAAM,CAAA5C,GAAG,CAAC+B,eAAe,CAACD,oBAAoB,CAACe,EAAE,CAAC,CAAC,CAC1F,KAAM,CAAA7C,GAAG,CAACiB,cAAc,CAACwB,IAAI,CAAC,CAAC,CACjC,CACA,MAAOJ,KAAK,CAAE,CACZ,KAAM,CAAArC,GAAG,CAACkB,YAAY,CAACmB,KAAK,CAACC,OAAO,CAAC,CAAC,CACtC,KAAM,CAAAtC,GAAG,CAAC6B,UAAU,CAACK,OAAO,CAACY,OAAO,CAAC,CAAC,CACxC,CACF,CAAC,IAED,QAAU,CAAAC,iBAAiBA,CAAAC,KAAA,KAAC,CAAEd,OAAQ,CAAC,CAAAc,KAAA,mBAAE,CACvC,GAAI,CAEF,KAAM,CAAAP,IAAI,CAAG,KAAM,CAAAvC,IAAI,CAACI,gBAAgB,CAAE4B,OAAO,CAAC,CAClD,KAAM,CAAAlC,GAAG,CAACoB,oBAAoB,CAAC,CAAE6B,MAAM,CAAER,IAAK,CAAC,CAAC,CAAC,CACjD,KAAM,CAAAzC,GAAG,CAAC4B,uBAAuB,CAAC,gCAAgC,CAAC,CAAC,CACtE,CACA,MAAOS,KAAK,CAAE,CACZ,KAAM,CAAArC,GAAG,CAACoB,oBAAoB,CAAC,CAC7BiB,KAAK,CAAEA,KAAK,CAACC,OACf,CAAC,CAAC,CAAC,CACL,CACF,CAAC,IAED,SAAUY,cAAcA,CAAA,CAAG,CACzB,GAAI,CACF,KAAM,CAAAT,IAAI,CAAG,KAAM,CAAAvC,IAAI,CAACK,iBAAiB,CAAC,CAC1C,KAAM,CAAAP,GAAG,CAACqB,qBAAqB,CAACoB,IAAI,CAAC,CAAC,CACtC,KAAM,CAAAzC,GAAG,CAAC4B,uBAAuB,CAAC,qDAAqD,CAAC,CAAC,CAC3F,CAAE,MAAOS,KAAK,CAAE,CACd,KAAM,CAAArC,GAAG,CAACsB,kBAAkB,CAAC,CAAEe,KAAK,CAAEA,KAAK,CAACC,OAAQ,CAAC,CAAC,CAAC,CACvD,KAAM,CAAAtC,GAAG,CAAC2B,qBAAqB,CAACU,KAAK,CAACC,OAAO,CAAC,CAAC,CACjD,CACF,CAEA,QAAU,CAAAa,kBAAkBA,CAAAC,KAAA,KAAC,CAAElB,OAAO,CAAEmB,QAAS,CAAC,CAAAD,KAAA,mBAAE,CAClD,GAAI,CACF,KAAM,CAAAE,SAAS,CAAGpB,OAAO,CACzB,KAAM,CAAAqB,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAE,cAAc,CAAC,CACvCF,QAAQ,CAACE,MAAM,CAAC,QAAQ,CAAEH,SAAS,CAAC,CAEpC,KAAM,CAAAb,IAAI,CAAG,KAAM,CAAAvC,IAAI,CAACM,sBAAsB,CAAE+C,QAAQ,CAAC,CACzD,KAAM,CAAAvD,GAAG,CAACuB,sBAAsB,CAAC,CAAEmC,OAAO,CAAEjB,IAAK,CAAC,CAAC,CAAC,CACpD,KAAM,CAAAzC,GAAG,CAAC4B,uBAAuB,CAAC,sCAAsC,CAAC,CAAC,CAC1E,GAAIyB,QAAQ,CAAE,CACZA,QAAQ,CAAC,CAAC,CACZ,CACF,CAAE,MAAOhB,KAAK,CAAE,CACd,KAAM,CAAArC,GAAG,CAACuB,sBAAsB,CAAC,CAAEc,KAAK,CAAEA,KAAK,CAACC,OAAQ,CAAC,CAAC,CAAC,CAC3D,KAAM,CAAAtC,GAAG,CAAC2B,qBAAqB,CAACU,KAAK,CAACC,OAAO,CAAC,CAAC,CACjD,CACF,CAAC,IAED,QAAU,CAAAqB,iBAAiBA,CAAAC,KAAA,KAAC,CAAEP,QAAS,CAAC,CAAAO,KAAA,mBAAE,CACxC,GAAI,CACF,KAAM,CAAAnB,IAAI,CAAG,KAAM,CAAAvC,IAAI,CAACM,sBAAsB,CAAE,CAAEqD,WAAW,CAAE,EAAG,CAAC,CAAC,CACpE,KAAM,CAAA7D,GAAG,CAACwB,oBAAoB,CAAC,CAAEkC,OAAO,CAAEjB,IAAK,CAAC,CAAC,CAAC,CAClD,KAAM,CAAAzC,GAAG,CAAC4B,uBAAuB,CAAC,qCAAqC,CAAC,CAAC,CACzE,GAAIyB,QAAQ,CAAE,CACZA,QAAQ,CAAC,CAAC,CACZ,CACF,CAAE,MAAOhB,KAAK,CAAE,CACd,KAAM,CAAArC,GAAG,CAACwB,oBAAoB,CAAC,CAAEa,KAAK,CAAEA,KAAK,CAACC,OAAQ,CAAC,CAAC,CAAC,CACzD,KAAM,CAAAtC,GAAG,CAAC2B,qBAAqB,CAACU,KAAK,CAACC,OAAO,CAAC,CAAC,CACjD,CACF,CAAC,IAED,QAAU,CAAAwB,qBAAqBA,CAAAC,KAAA,KAAC,CAAE7B,OAAQ,CAAC,CAAA6B,KAAA,mBAAE,CAC3C,GAAI,CACF,KAAM,CAAAtB,IAAI,CAAG,KAAM,CAAAvC,IAAI,CAACO,sBAAsB,CAAEyB,OAAO,CAAC,CACxD8B,OAAO,CAACC,GAAG,CAAC,SAAS,CAAExB,IAAI,CAAC,CAC5BuB,OAAO,CAACC,GAAG,CAAC,SAAS,CAAE/B,OAAO,CAAC,CAC/B,KAAM,CAAAlC,GAAG,CAACyB,4BAA4B,CAACS,OAAO,CAAC,CAAC,CAChD,KAAM,CAAAlC,GAAG,CAAC4B,uBAAuB,CAAC,uCAAuC,CAAC,CAAC,CAC7E,CAAE,MAAOS,KAAK,CAAE,CACd,KAAM,CAAArC,GAAG,CAAC0B,yBAAyB,CAAC,CAAEW,KAAK,CAAEA,KAAK,CAACC,OAAQ,CAAC,CAAC,CAAC,CAC9D,KAAM,CAAAtC,GAAG,CAAC2B,qBAAqB,CAACU,KAAK,CAACC,OAAO,CAAC,CAAC,CACjD,CACF,CAAC,IAED,MAAO,UAAU4B,YAAYA,CAAA,CAAG,CAC9B,KAAM,CAAApE,SAAS,CAACY,YAAY,CAAEsB,WAAW,CAAC,CAC1C,KAAM,CAAAlC,SAAS,CAACa,mBAAmB,CAAE4B,YAAY,CAAC,CAClD,KAAM,CAAAzC,SAAS,CAACc,wBAAwB,CAAEmC,iBAAiB,CAAC,CAC5D,KAAM,CAAAjD,SAAS,CAACe,yBAAyB,CAAEqC,cAAc,CAAC,CAC1D,KAAM,CAAA/C,UAAU,CAACW,2BAA2B,CAAEqC,kBAAkB,CAAC,CACjE,KAAM,CAAAhD,UAAU,CAACY,2BAA2B,CAAE4C,iBAAiB,CAAC,CAChE,KAAM,CAAAxD,UAAU,CAACa,uBAAuB,CAAE8C,qBAAqB,CAAC,CAClE,CAEA,SAAUK,WAAWA,CAAA,CAAG,CACtB,KAAM,CAAAlE,GAAG,CAAC,CAACF,IAAI,CAACmE,YAAY,CAAC,CAAC,CAAC,CACjC,CAEA,cAAe,CAAAC,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module"}