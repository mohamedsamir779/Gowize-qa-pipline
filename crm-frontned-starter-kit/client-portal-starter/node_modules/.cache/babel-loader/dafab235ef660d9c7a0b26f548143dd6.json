{"ast":null,"code":"import React,{useState}from\"react\";import{MetaTags}from\"react-meta-tags\";import{Button,Container,Spinner}from\"reactstrap\";import{useTranslation}from\"react-i18next\";import Widgets from\"components/Common/Widgets\";import NotificationList from\"./NotificationList\";import NotificationSettings from\"./NotificationSettings\";import{useDispatch,useSelector}from\"react-redux\";import*as rdd from\"react-device-detect\";import{subscribeUserToPush,unsubscribeFromPushNotification}from\"serviceWorkerRegistration\";import{subscribePushNotification,unsubscribePushNotifications}from\"store/general/subscriptions/actions\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Notifications(){const{t}=useTranslation();const dispatch=useDispatch();const[activeTab,setTab]=useState(0);const{subscriptionLoading,settings}=useSelector(state=>({subscriptionLoading:state.subscriptionsReducer.loading,settings:state.Profile.clientData.settings||{}}));const getEnableDisableButton=function(){let buttonAction=arguments.length>0&&arguments[0]!==undefined?arguments[0]:()=>{};let loading=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let buttonText=settings.localAndClientPushNotifications?t(\"Disable\"):t(\"Enable\");let buttonClass=settings.localAndClientPushNotifications?\"btn-danger\":\"btn-success\";return/*#__PURE__*/_jsxs(Button,{className:\"border-0 mb-4 \".concat(buttonClass),onClick:buttonAction,disabled:loading,children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-bell font-size-16 align-middle me-1\"}),loading?/*#__PURE__*/_jsx(Spinner,{}):buttonText]});};const subAndSaveSubscription=async e=>{if(settings.localAndClientPushNotifications){const unsubData=await unsubscribeFromPushNotification();dispatch(unsubscribePushNotifications(unsubData.endpoint));}else{e.preventDefault();let subs=await subscribeUserToPush();subs=JSON.parse(JSON.stringify(subs));const data={endpoint:subs.endpoint,expirationTime:subs.expirationTime,keys:subs.keys,deviceDetails:{browserName:(rdd===null||rdd===void 0?void 0:rdd.browserName)||\"Not Found\",browserVersion:(rdd===null||rdd===void 0?void 0:rdd.browserVersion)||\"Not Found\",deviceType:(rdd===null||rdd===void 0?void 0:rdd.deviceType)||\"Not Found\",osName:(rdd===null||rdd===void 0?void 0:rdd.osName)||\"Not Found\",osVersion:(rdd===null||rdd===void 0?void 0:rdd.osVersion)||\"Not Found\",mobileVendor:(rdd===null||rdd===void 0?void 0:rdd.mobileVendor)||\"Not Found\",mobileModel:(rdd===null||rdd===void 0?void 0:rdd.mobileModel)||\"Not Found\",userAgent:(rdd===null||rdd===void 0?void 0:rdd.getUA)||\"Not Found\",engineName:(rdd===null||rdd===void 0?void 0:rdd.engineName)||\"Not Found\",engineVersion:(rdd===null||rdd===void 0?void 0:rdd.engineVersion)||\"Not Found\",fullBrowserVersion:(rdd===null||rdd===void 0?void 0:rdd.fullBrowserVersion)||\"Not Found\"}};dispatch(subscribePushNotification(data));}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsx(MetaTags,{children:/*#__PURE__*/_jsx(\"title\",{children:t(\"Notifications\")})}),/*#__PURE__*/_jsxs(Container,{className:\"mb-5 mt-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-4 me-4\",children:t(\"Push Notifications\")}),/*#__PURE__*/_jsx(\"div\",{className:\"my-auto\",children:getEnableDisableButton(subAndSaveSubscription,subscriptionLoading)})]}),/*#__PURE__*/_jsx(Widgets,{setTab:setTab,tabs:[\"Notifications List\",\"Notification Settings\"],children:/*#__PURE__*/_jsxs(Container,{children:[activeTab===0&&/*#__PURE__*/_jsx(NotificationList,{}),activeTab===1&&/*#__PURE__*/_jsx(NotificationSettings,{})]})})]})]})});}export default Notifications;","map":{"version":3,"names":["React","useState","MetaTags","Button","Container","Spinner","useTranslation","Widgets","NotificationList","NotificationSettings","useDispatch","useSelector","rdd","subscribeUserToPush","unsubscribeFromPushNotification","subscribePushNotification","unsubscribePushNotifications","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Notifications","t","dispatch","activeTab","setTab","subscriptionLoading","settings","state","subscriptionsReducer","loading","Profile","clientData","getEnableDisableButton","buttonAction","arguments","length","undefined","buttonText","localAndClientPushNotifications","buttonClass","className","concat","onClick","disabled","children","subAndSaveSubscription","e","unsubData","endpoint","preventDefault","subs","JSON","parse","stringify","data","expirationTime","keys","deviceDetails","browserName","browserVersion","deviceType","osName","osVersion","mobileVendor","mobileModel","userAgent","getUA","engineName","engineVersion","fullBrowserVersion","tabs"],"sources":["/home/ubuntu/king/portal/client-portal-starter/src/pages/Authentication/Notifications/index.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { MetaTags } from \"react-meta-tags\";\nimport {\n  Button,\n  Container,\n  Spinner\n} from \"reactstrap\";\nimport { useTranslation } from \"react-i18next\";\nimport Widgets from \"components/Common/Widgets\";\nimport NotificationList from \"./NotificationList\";\nimport NotificationSettings from \"./NotificationSettings\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport * as rdd from \"react-device-detect\";\nimport { subscribeUserToPush, unsubscribeFromPushNotification } from \"serviceWorkerRegistration\";\nimport { subscribePushNotification, unsubscribePushNotifications } from \"store/general/subscriptions/actions\";\n\nfunction Notifications() {\n  const { t } = useTranslation();\n  const dispatch = useDispatch();\n  const [activeTab, setTab] = useState(0);\n\n  const {\n    subscriptionLoading,\n    settings,\n  } = useSelector((state) => ({\n    subscriptionLoading: state.subscriptionsReducer.loading,\n    settings: state.Profile.clientData.settings || {},\n  }));\n\n  const getEnableDisableButton = (\n    buttonAction = () => { },\n    loading = false\n  ) => {\n    let buttonText = settings.localAndClientPushNotifications ? t(\"Disable\") : t(\"Enable\");\n    let buttonClass = settings.localAndClientPushNotifications ? \"btn-danger\" : \"btn-success\";\n    return (\n      <Button\n        className={`border-0 mb-4 ${buttonClass}`}\n        onClick={buttonAction}\n        disabled={loading}\n      >\n        <i className=\"bx bx-bell font-size-16 align-middle me-1\" />{loading ? <Spinner /> : buttonText}\n      </Button>\n    );\n  };\n\n  const subAndSaveSubscription = async (e) => {\n    if (settings.localAndClientPushNotifications) {\n      const unsubData = await unsubscribeFromPushNotification();\n      dispatch(unsubscribePushNotifications(unsubData.endpoint));\n    } else {\n      e.preventDefault();\n      let subs = await subscribeUserToPush();\n      subs = JSON.parse(JSON.stringify(subs));\n      const data = {\n        endpoint: subs.endpoint,\n        expirationTime: subs.expirationTime,\n        keys: subs.keys,\n        deviceDetails: {\n          browserName: rdd?.browserName || \"Not Found\",\n          browserVersion: rdd?.browserVersion || \"Not Found\",\n          deviceType: rdd?.deviceType || \"Not Found\",\n          osName: rdd?.osName || \"Not Found\",\n          osVersion: rdd?.osVersion || \"Not Found\",\n          mobileVendor: rdd?.mobileVendor || \"Not Found\",\n          mobileModel: rdd?.mobileModel || \"Not Found\",\n          userAgent: rdd?.getUA || \"Not Found\",\n          engineName: rdd?.engineName || \"Not Found\",\n          engineVersion: rdd?.engineVersion || \"Not Found\",\n          fullBrowserVersion: rdd?.fullBrowserVersion || \"Not Found\",\n        }\n      };\n      dispatch(subscribePushNotification(data));\n    }\n  };\n\n  return (\n    <>\n      <div className=\"page-content\">\n        <MetaTags>\n          <title>{t(\"Notifications\")}</title>\n        </MetaTags>\n        <Container className=\"mb-5 mt-5\">\n          <div className=\"d-flex flex-row\">\n            <h1 className=\"mb-4 me-4\">\n              {t(\"Push Notifications\")}\n            </h1>\n            <div className=\"my-auto\">\n              {getEnableDisableButton(subAndSaveSubscription, subscriptionLoading)}\n            </div>\n          </div>\n          <Widgets\n            setTab={setTab}\n            tabs={[\"Notifications List\", \"Notification Settings\"]}\n          >\n            <Container>\n              {activeTab === 0 && <NotificationList />}\n              {activeTab === 1 && <NotificationSettings />}\n            </Container>\n          </Widgets>\n        </Container>\n      </div>\n    </>\n  );\n}\n\nexport default Notifications;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}