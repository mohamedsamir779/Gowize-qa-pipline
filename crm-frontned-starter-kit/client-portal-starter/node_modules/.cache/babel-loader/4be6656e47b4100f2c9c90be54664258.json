{"ast":null,"code":"import{call,put,takeEvery}from\"redux-saga/effects\";// Login Redux States\nimport{LOGIN_USER,LOGOUT_USER}from\"./actionTypes\";import{apiError,loginSuccess}from\"./actions\";import{changePortal,switchSubPortal}from\"../../actions\";import{loginUserAPI}from\"../../../../apis/auth\";import{HIDE_JOU_KYC,HIDE_JOU_IND_PROFILE,HIDE_JOU_FUND,HIDE_JOU_TRADING}from\"common/data/jourenykeys\";import{toggleCurrentModal}from\"store/actions\";function loginUser(_ref){let{payload:{user,history}}=_ref;return function*(){try{const data=yield call(loginUserAPI,user);const{result,status}=data;if(status){if(!result.token){yield put(toggleCurrentModal(\"TwoFactorAuth\",{email:user.email,type:\"login\"}));yield put(loginSuccess(result));}if(result.token){localStorage.setItem(\"authUser\",JSON.stringify(result));localStorage.setItem(\"PORTAL\",result.defaultPortal);yield put(changePortal(result.defaultPortal));yield put(switchSubPortal(result.defaultSubPortal));yield put(loginSuccess(result));history.push(\"/dashboard\");}}else{yield put(apiError((data===null||data===void 0?void 0:data.message)||\"Incorrect email or password\"));}}catch(error){yield put(apiError(error));}}();}function logoutUser(_ref2){let{payload:{history}}=_ref2;return function*(){try{localStorage.removeItem(\"authUser\");localStorage.removeItem(HIDE_JOU_KYC);localStorage.removeItem(HIDE_JOU_IND_PROFILE);localStorage.removeItem(HIDE_JOU_FUND);localStorage.removeItem(HIDE_JOU_TRADING);history.push(\"/login\");}catch(error){yield put(apiError(error));}}();}function*authSaga(){yield takeEvery(LOGIN_USER,loginUser);yield takeEvery(LOGOUT_USER,logoutUser);}export default authSaga;","map":{"version":3,"names":["call","put","takeEvery","LOGIN_USER","LOGOUT_USER","apiError","loginSuccess","changePortal","switchSubPortal","loginUserAPI","HIDE_JOU_KYC","HIDE_JOU_IND_PROFILE","HIDE_JOU_FUND","HIDE_JOU_TRADING","toggleCurrentModal","loginUser","_ref","payload","user","history","data","result","status","token","email","type","localStorage","setItem","JSON","stringify","defaultPortal","defaultSubPortal","push","message","error","logoutUser","_ref2","removeItem","authSaga"],"sources":["/home/ubuntu/king/portal/client-portal-starter/src/store/general/auth/login/saga.js"],"sourcesContent":["import {\n  call, put, takeEvery\n} from \"redux-saga/effects\";\n\n// Login Redux States\nimport {\n  LOGIN_USER, LOGOUT_USER\n} from \"./actionTypes\";\nimport {\n  apiError, loginSuccess\n} from \"./actions\";\nimport { changePortal, switchSubPortal } from \"../../actions\";\nimport { loginUserAPI } from \"../../../../apis/auth\";\nimport {\n  HIDE_JOU_KYC, HIDE_JOU_IND_PROFILE, HIDE_JOU_FUND, HIDE_JOU_TRADING\n} from \"common/data/jourenykeys\";\nimport { toggleCurrentModal } from \"store/actions\";\n\nfunction* loginUser({ payload: { user, history } }) {\n  try {\n    const data = yield call(loginUserAPI, user);\n    const { result, status } = data;\n    if (status) {\n      if (!result.token) {\n        yield put(toggleCurrentModal(\"TwoFactorAuth\", {\n          email: user.email,\n          type: \"login\",\n        }));\n        yield put(loginSuccess(result));\n      }\n      if (result.token) {\n        localStorage.setItem(\"authUser\", JSON.stringify(result));\n        localStorage.setItem(\"PORTAL\", result.defaultPortal);\n        yield put(changePortal(result.defaultPortal));\n        yield put(switchSubPortal(result.defaultSubPortal));\n        yield put(loginSuccess(result));\n        history.push(\"/dashboard\");\n      }\n    } else {\n      yield put(apiError(data?.message || \"Incorrect email or password\"));\n    }\n  }\n  catch (error) {\n    yield put(apiError(error));\n  }\n}\n\n\nfunction* logoutUser({ payload: { history } }) {\n  try {\n    localStorage.removeItem(\"authUser\");\n    localStorage.removeItem(HIDE_JOU_KYC);\n    localStorage.removeItem(HIDE_JOU_IND_PROFILE);\n    localStorage.removeItem(HIDE_JOU_FUND);\n    localStorage.removeItem(HIDE_JOU_TRADING);\n\n    history.push(\"/login\");\n  } catch (error) {\n    yield put(apiError(error));\n  }\n}\n\n\nfunction* authSaga() {\n  yield takeEvery(LOGIN_USER, loginUser);\n  yield takeEvery(LOGOUT_USER, logoutUser);\n}\n\nexport default authSaga;\n"],"mappings":"AAAA,OACEA,IAAI,CAAEC,GAAG,CAAEC,SAAS,KACf,oBAAoB,CAE3B;AACA,OACEC,UAAU,CAAEC,WAAW,KAClB,eAAe,CACtB,OACEC,QAAQ,CAAEC,YAAY,KACjB,WAAW,CAClB,OAASC,YAAY,CAAEC,eAAe,KAAQ,eAAe,CAC7D,OAASC,YAAY,KAAQ,uBAAuB,CACpD,OACEC,YAAY,CAAEC,oBAAoB,CAAEC,aAAa,CAAEC,gBAAgB,KAC9D,yBAAyB,CAChC,OAASC,kBAAkB,KAAQ,eAAe,CAElD,QAAU,CAAAC,SAASA,CAAAC,IAAA,KAAC,CAAEC,OAAO,CAAE,CAAEC,IAAI,CAAEC,OAAQ,CAAE,CAAC,CAAAH,IAAA,mBAAE,CAClD,GAAI,CACF,KAAM,CAAAI,IAAI,CAAG,KAAM,CAAApB,IAAI,CAACS,YAAY,CAAES,IAAI,CAAC,CAC3C,KAAM,CAAEG,MAAM,CAAEC,MAAO,CAAC,CAAGF,IAAI,CAC/B,GAAIE,MAAM,CAAE,CACV,GAAI,CAACD,MAAM,CAACE,KAAK,CAAE,CACjB,KAAM,CAAAtB,GAAG,CAACa,kBAAkB,CAAC,eAAe,CAAE,CAC5CU,KAAK,CAAEN,IAAI,CAACM,KAAK,CACjBC,IAAI,CAAE,OACR,CAAC,CAAC,CAAC,CACH,KAAM,CAAAxB,GAAG,CAACK,YAAY,CAACe,MAAM,CAAC,CAAC,CACjC,CACA,GAAIA,MAAM,CAACE,KAAK,CAAE,CAChBG,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEC,IAAI,CAACC,SAAS,CAACR,MAAM,CAAC,CAAC,CACxDK,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAEN,MAAM,CAACS,aAAa,CAAC,CACpD,KAAM,CAAA7B,GAAG,CAACM,YAAY,CAACc,MAAM,CAACS,aAAa,CAAC,CAAC,CAC7C,KAAM,CAAA7B,GAAG,CAACO,eAAe,CAACa,MAAM,CAACU,gBAAgB,CAAC,CAAC,CACnD,KAAM,CAAA9B,GAAG,CAACK,YAAY,CAACe,MAAM,CAAC,CAAC,CAC/BF,OAAO,CAACa,IAAI,CAAC,YAAY,CAAC,CAC5B,CACF,CAAC,IAAM,CACL,KAAM,CAAA/B,GAAG,CAACI,QAAQ,CAAC,CAAAe,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEa,OAAO,GAAI,6BAA6B,CAAC,CAAC,CACrE,CACF,CACA,MAAOC,KAAK,CAAE,CACZ,KAAM,CAAAjC,GAAG,CAACI,QAAQ,CAAC6B,KAAK,CAAC,CAAC,CAC5B,CACF,CAAC,IAGD,QAAU,CAAAC,UAAUA,CAAAC,KAAA,KAAC,CAAEnB,OAAO,CAAE,CAAEE,OAAQ,CAAE,CAAC,CAAAiB,KAAA,mBAAE,CAC7C,GAAI,CACFV,YAAY,CAACW,UAAU,CAAC,UAAU,CAAC,CACnCX,YAAY,CAACW,UAAU,CAAC3B,YAAY,CAAC,CACrCgB,YAAY,CAACW,UAAU,CAAC1B,oBAAoB,CAAC,CAC7Ce,YAAY,CAACW,UAAU,CAACzB,aAAa,CAAC,CACtCc,YAAY,CAACW,UAAU,CAACxB,gBAAgB,CAAC,CAEzCM,OAAO,CAACa,IAAI,CAAC,QAAQ,CAAC,CACxB,CAAE,MAAOE,KAAK,CAAE,CACd,KAAM,CAAAjC,GAAG,CAACI,QAAQ,CAAC6B,KAAK,CAAC,CAAC,CAC5B,CACF,CAAC,IAGD,SAAUI,QAAQA,CAAA,CAAG,CACnB,KAAM,CAAApC,SAAS,CAACC,UAAU,CAAEY,SAAS,CAAC,CACtC,KAAM,CAAAb,SAAS,CAACE,WAAW,CAAE+B,UAAU,CAAC,CAC1C,CAEA,cAAe,CAAAG,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module"}