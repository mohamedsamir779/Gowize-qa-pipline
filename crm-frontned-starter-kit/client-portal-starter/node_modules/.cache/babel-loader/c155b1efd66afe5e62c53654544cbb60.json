{"ast":null,"code":"import React from\"react\";import{connect}from\"react-redux\";import{Spinner}from\"reactstrap\";//i18n\nimport{withTranslation}from\"react-i18next\";import CustomTable from\"../../components/Common/CustomTable\";import*as content from\"content\";import axios from\"axios\";import{Fragment as _Fragment,jsx as _jsx}from\"react/jsx-runtime\";function DocumentList(props){var _props$documents,_props$documents2;const imagesUrl=content.imagesUrl;const docs=(_props$documents=props.documents)===null||_props$documents===void 0?void 0:_props$documents.map(obj=>{let arr=[obj.file1];if(obj.file2){arr.push({originalname:\" \"});arr.push(obj.file2);}obj.files=arr;return obj;});// const [deleteModal, setDeleteModal] = React.useState({\n//   show: false,\n//   documentId: null,\n//   clientId: null,\n// });\nfunction titleCase(str){let tmpArr=str.toLowerCase().split(\"_\");return tmpArr.map(obj=>{return obj[0].toUpperCase()+obj.slice(1);}).join(\" \");}function getFileLink(obj,index,id){var _obj$filename,_obj$filename$split,_obj$fileName,_obj$fileName$split;if(!obj||!obj.url)return/*#__PURE__*/_jsx(_Fragment,{});const getSecureLink=()=>{var _JSON$parse;axios.get(\"\".concat(content.apiUrl,\"/api/v1/crm/documents/\").concat(id,\"/\").concat(index),{headers:{\"Authorization\":\"Bearer \".concat((_JSON$parse=JSON.parse(localStorage.getItem(\"authUser\")))===null||_JSON$parse===void 0?void 0:_JSON$parse.token)}}).then(res=>{window.open(res.data.result,\"_blank\");}).catch(err=>{console.log(err);});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"a\",{onClick:()=>getSecureLink(obj.url),style:{color:\"#405189\",cursor:\"pointer\"},children:(obj===null||obj===void 0?void 0:(_obj$filename=obj.filename)===null||_obj$filename===void 0?void 0:(_obj$filename$split=_obj$filename.split(\"/\"))===null||_obj$filename$split===void 0?void 0:_obj$filename$split.pop())||(obj===null||obj===void 0?void 0:(_obj$fileName=obj.fileName)===null||_obj$fileName===void 0?void 0:(_obj$fileName$split=_obj$fileName.split(\"/\"))===null||_obj$fileName$split===void 0?void 0:_obj$fileName$split.pop())||index})});}const getClientName=id=>{var _props$clientData,_props$clientData$cor,_props$clientData$cor2;const client=(_props$clientData=props.clientData)===null||_props$clientData===void 0?void 0:(_props$clientData$cor=_props$clientData.corporateInfo)===null||_props$clientData$cor===void 0?void 0:(_props$clientData$cor2=_props$clientData$cor.shareholders)===null||_props$clientData$cor2===void 0?void 0:_props$clientData$cor2.find(obj=>obj._id===id);if(!id){var _props$clientData2,_props$clientData2$co;const auth=(_props$clientData2=props.clientData)===null||_props$clientData2===void 0?void 0:(_props$clientData2$co=_props$clientData2.corporateInfo)===null||_props$clientData2$co===void 0?void 0:_props$clientData2$co.authorizedPerson;return(auth===null||auth===void 0?void 0:auth.firstName)+\" \"+(auth===null||auth===void 0?void 0:auth.lastName);}return(client===null||client===void 0?void 0:client.firstName)+\" \"+(client===null||client===void 0?void 0:client.lastName);};const columns=[{dataField:\"createdAt\",text:props.t(\"Created Date\"),formatter:val=>new Date(val.createdAt).toLocaleDateString()},{dataField:\"type\",text:props.t(\"Type\"),formatter:val=>\"\".concat(titleCase(val.type),\" \").concat(val.subType?\"- \".concat(titleCase(val.subType),\" (\").concat(titleCase(getClientName(val.shareholderId)),\")\"):\"\")},{dataField:\"files\",text:props.t(\"Files\"),formatter:val=>val.files.map((obj,index)=>getFileLink(obj,index+1,val===null||val===void 0?void 0:val._id))},{dataField:\"status\",text:props.t(\"Status\"),formatter:val=>titleCase(val.status)},{dataField:\"status\",text:\"\",formatter:val=>{return val.rejectionReason?val.rejectionReason:\"\";}}];if(props.loading){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center justify-content-center\",children:/*#__PURE__*/_jsx(Spinner,{})});}return/*#__PURE__*/_jsx(_Fragment,{children:((_props$documents2=props.documents)===null||_props$documents2===void 0?void 0:_props$documents2.length)>0?/*#__PURE__*/_jsx(CustomTable,{columns:columns,rows:docs}):/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center justify-content-center\",style:{width:\"100%\"},children:props.t(\"No document uploaded\")})});}const mapStateToProps=state=>({loading:state.documents.loading,clearChangeStatus:state.documents.clearChangeStatus,clearDelete:state.documents.clearDelete,documents:state.documents.documents,clientData:state.Profile.clientData,error:state.documents.error});export default connect(mapStateToProps,null)(withTranslation()(DocumentList));","map":{"version":3,"names":["React","connect","Spinner","withTranslation","CustomTable","content","axios","Fragment","_Fragment","jsx","_jsx","DocumentList","props","_props$documents","_props$documents2","imagesUrl","docs","documents","map","obj","arr","file1","file2","push","originalname","files","titleCase","str","tmpArr","toLowerCase","split","toUpperCase","slice","join","getFileLink","index","id","_obj$filename","_obj$filename$split","_obj$fileName","_obj$fileName$split","url","getSecureLink","_JSON$parse","get","concat","apiUrl","headers","JSON","parse","localStorage","getItem","token","then","res","window","open","data","result","catch","err","console","log","children","onClick","style","color","cursor","filename","pop","fileName","getClientName","_props$clientData","_props$clientData$cor","_props$clientData$cor2","client","clientData","corporateInfo","shareholders","find","_id","_props$clientData2","_props$clientData2$co","auth","authorizedPerson","firstName","lastName","columns","dataField","text","t","formatter","val","Date","createdAt","toLocaleDateString","type","subType","shareholderId","status","rejectionReason","loading","className","length","rows","width","mapStateToProps","state","clearChangeStatus","clearDelete","Profile","error"],"sources":["/home/ubuntu/king/portal/client-portal-starter/src/pages/Documents/DocumnetsList.js"],"sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Spinner } from \"reactstrap\";\n\n//i18n\nimport { withTranslation } from \"react-i18next\";\nimport CustomTable from \"../../components/Common/CustomTable\";\nimport * as content from \"content\";\nimport axios from \"axios\";\n\nfunction DocumentList(props) {\n  const imagesUrl = content.imagesUrl;\n\n  const docs = props.documents?.map((obj) => {\n    let arr = [obj.file1];\n    if (obj.file2) {\n      arr.push({ originalname: \" \" });\n      arr.push(obj.file2);\n    }\n    obj.files = arr;\n\n    return obj;\n  });\n\n  // const [deleteModal, setDeleteModal] = React.useState({\n  //   show: false,\n  //   documentId: null,\n  //   clientId: null,\n  // });\n\n  function titleCase(str) {\n    let tmpArr = str.toLowerCase().split(\"_\");\n\n    return tmpArr\n      .map((obj) => {\n        return obj[0].toUpperCase() + obj.slice(1);\n      })\n      .join(\" \");\n  }\n\n  function getFileLink(obj, index, id) {\n    if (!obj || !obj.url) return <></>;\n    const getSecureLink = () => {\n      axios.get(`${content.apiUrl}/api/v1/crm/documents/${id}/${index}`, {\n        headers: {\n          \"Authorization\": `Bearer ${JSON.parse(localStorage.getItem(\"authUser\"))?.token}`\n        }\n      }).then(res => {\n        window.open(res.data.result, \"_blank\");\n      }\n      ).catch(err => {\n        console.log(err);\n      });\n    };\n    return <div><a onClick={() => getSecureLink(obj.url)} style={{\n      color: \"#405189\",\n      cursor: \"pointer\"\n    }}  >{obj?.filename?.split(\"/\")?.pop() || obj?.fileName?.split(\"/\")?.pop() || index}</a></div>;\n  }\n\n  const getClientName = (id) => {\n    const client = props.clientData?.corporateInfo?.shareholders?.find((obj) => obj._id === id);\n    if (!id) {\n      const auth = props.clientData?.corporateInfo?.authorizedPerson;\n      return auth?.firstName + \" \" + auth?.lastName;\n    }\n    return client?.firstName + \" \" + client?.lastName;\n  };\n\n  const columns = [\n    {\n      dataField: \"createdAt\",\n      text: props.t(\"Created Date\"),\n      formatter: (val) => new Date(val.createdAt).toLocaleDateString(),\n    },\n    {\n      dataField: \"type\",\n      text: props.t(\"Type\"),\n      formatter: (val) => `${titleCase(val.type)} ${val.subType ? `- ${titleCase(val.subType)} (${titleCase(getClientName(val.shareholderId))})` : \"\"}`,\n    },\n    {\n      dataField: \"files\",\n      text: props.t(\"Files\"),\n      formatter: (val) => val.files.map((obj, index) => getFileLink(obj, index + 1, val?._id)),\n    },\n    {\n      dataField: \"status\",\n      text: props.t(\"Status\"),\n      formatter: (val) => titleCase(val.status),\n    },\n    {\n      dataField: \"status\",\n      text: \"\",\n      formatter: (val) => {\n        return val.rejectionReason ? val.rejectionReason : \"\";\n      },\n    },\n  ];\n  if (props.loading) {\n    return (\n      <div className=\"d-flex align-items-center justify-content-center\">\n        <Spinner />\n      </div>\n    );\n  }\n\n  return (\n    <>\n      {props.documents?.length > 0 ? (\n        <CustomTable columns={columns} rows={docs} />\n      ) : (\n        <div className=\"d-flex align-items-center justify-content-center\" style={{ width: \"100%\" }}>\n          {props.t(\"No document uploaded\")}\n        </div>\n      )}\n    </>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  loading: state.documents.loading,\n  clearChangeStatus: state.documents.clearChangeStatus,\n  clearDelete: state.documents.clearDelete,\n  documents: state.documents.documents,\n  clientData: state.Profile.clientData,\n  error: state.documents.error,\n});\nexport default connect(mapStateToProps, null)(withTranslation()(DocumentList));\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}