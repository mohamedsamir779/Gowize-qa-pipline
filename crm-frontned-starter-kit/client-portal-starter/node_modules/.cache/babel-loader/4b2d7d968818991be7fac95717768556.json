{"ast":null,"code":"import{Suspense,useEffect}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{Switch,BrowserRouter as Router}from\"react-router-dom\";import SocketProvider from\"./context\";import Authmiddleware from\"./routes/middleware/Authmiddleware\";import VerticalLayout from\"./components/VerticalLayout/\";import NonAuthLayout from\"./components/NonAuthLayout\";import AppLoader from\"./components/AppLoader\";import forexRoutes from\"./routes/forexRoutes\";import cryptoRoutes from\"./routes/cryptoRoutes\";import{IS_IOS,PORTALS}from\"common/constants\";import\"./assets/scss/preloader.scss\";import\"./assets/scss/theme.scss\";import{defaultPortal,enableCrypto,enableFX}from\"config\";import{receivedNotification,updatePushNotificationOption}from\"store/actions\";import{checkPushNotificationSubscription}from\"serviceWorkerRegistration\";import formatReceivedNotification from\"helpers/formatReceivedNotification\";import{jsx as _jsx}from\"react/jsx-runtime\";const lang=localStorage.getItem(\"I18N_LANGUAGE\");if(lang===\"ar\"){import(\"./assets/scss/theme-rtl.scss\");}const routeSelector=portal=>{let defaultRoutes;switch(defaultPortal){// case PORTALS.CRYPTO:\n//   defaultRoutes = cryptoRoutes;\n//   break;\ncase PORTALS.FOREX:defaultRoutes=forexRoutes;break;default:defaultRoutes=forexRoutes;break;}switch(portal){// case PORTALS.CRYPTO:\n//   if (enableCrypto)\n//     return cryptoRoutes;\n//   else\n//     return defaultRoutes;\ncase PORTALS.FOREX:if(enableFX)return forexRoutes;else return defaultRoutes;default:return defaultRoutes;}};const channel=new BroadcastChannel(\"notification--exinitic--messages\");const App=()=>{var _Notification;const dispatch=useDispatch();const notification=!IS_IOS&&((_Notification=Notification)===null||_Notification===void 0?void 0:_Notification.permission)||null;const{portal}=useSelector(state=>state.Layout);let routes=routeSelector(portal);channel.onmessage=event=>{const formattedData=formatReceivedNotification(event.data);if(formattedData._id){dispatch(receivedNotification(formattedData));}};useEffect(async()=>{const checkCurrentNotification=await checkPushNotificationSubscription();dispatch(updatePushNotificationOption(checkCurrentNotification));},[notification]);return/*#__PURE__*/_jsx(SocketProvider,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(AppLoader,{}),children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(Switch,{children:routes.map((route,idx)=>/*#__PURE__*/_jsx(Authmiddleware,{path:route.path,layout:route.isAuth?VerticalLayout:NonAuthLayout,component:route.component,isAuthProtected:route.isAuth?true:false,exact:true},idx))})})})});};export default App;","map":{"version":3,"names":["Suspense","useEffect","useSelector","useDispatch","Switch","BrowserRouter","Router","SocketProvider","Authmiddleware","VerticalLayout","NonAuthLayout","AppLoader","forexRoutes","cryptoRoutes","IS_IOS","PORTALS","defaultPortal","enableCrypto","enableFX","receivedNotification","updatePushNotificationOption","checkPushNotificationSubscription","formatReceivedNotification","jsx","_jsx","lang","localStorage","getItem","routeSelector","portal","defaultRoutes","FOREX","channel","BroadcastChannel","App","_Notification","dispatch","notification","Notification","permission","state","Layout","routes","onmessage","event","formattedData","data","_id","checkCurrentNotification","children","fallback","map","route","idx","path","layout","isAuth","component","isAuthProtected","exact"],"sources":["/home/ubuntu/king/portal/client-portal-starter/src/App.js"],"sourcesContent":["import {\n  Suspense,\n  useEffect,\n} from \"react\";\nimport {\n  useSelector,\n  useDispatch,\n} from \"react-redux\";\nimport { Switch, BrowserRouter as Router } from \"react-router-dom\";\n\nimport SocketProvider from \"./context\";\n\nimport Authmiddleware from \"./routes/middleware/Authmiddleware\";\n\nimport VerticalLayout from \"./components/VerticalLayout/\";\nimport NonAuthLayout from \"./components/NonAuthLayout\";\nimport AppLoader from \"./components/AppLoader\";\n\nimport forexRoutes from \"./routes/forexRoutes\";\nimport cryptoRoutes from \"./routes/cryptoRoutes\"; \nimport { IS_IOS, PORTALS } from \"common/constants\";\n\nimport \"./assets/scss/preloader.scss\";\nimport \"./assets/scss/theme.scss\";\nimport {\n  defaultPortal,\n  enableCrypto,\n  enableFX,\n} from \"config\";\nimport { receivedNotification, updatePushNotificationOption } from \"store/actions\";\nimport { checkPushNotificationSubscription } from \"serviceWorkerRegistration\";\nimport formatReceivedNotification from \"helpers/formatReceivedNotification\";\n\n\nconst lang = localStorage.getItem(\"I18N_LANGUAGE\");\nif (lang === \"ar\") {\n  import(\"./assets/scss/theme-rtl.scss\");\n}\n\nconst routeSelector = (portal) => {\n  let defaultRoutes;\n  switch (defaultPortal) {\n    // case PORTALS.CRYPTO:\n    //   defaultRoutes = cryptoRoutes;\n    //   break;\n    case PORTALS.FOREX:\n      defaultRoutes = forexRoutes;\n      break;\n      default: defaultRoutes = forexRoutes;\n      break;  \n  }\n  switch (portal) {\n    // case PORTALS.CRYPTO:\n    //   if (enableCrypto)\n    //     return cryptoRoutes;\n    //   else\n    //     return defaultRoutes;\n    case PORTALS.FOREX:\n      if (enableFX)\n        return forexRoutes;\n      else\n        return defaultRoutes;\n    default: return defaultRoutes;\n  }\n};\n\nconst channel = new BroadcastChannel(\"notification--exinitic--messages\");\n\nconst App = () => {\n  const dispatch = useDispatch();\n  const notification = (!IS_IOS && Notification?.permission) || null;\n\n  const { portal } = useSelector((state) => state.Layout);\n  let routes = routeSelector(portal);\n\n  channel.onmessage = (event) => {\n    const formattedData = formatReceivedNotification(event.data);\n    if (formattedData._id) {\n      dispatch(receivedNotification(formattedData));\n    }\n  };\n\n  useEffect(async () => {\n    const checkCurrentNotification = await checkPushNotificationSubscription();\n    dispatch(updatePushNotificationOption(checkCurrentNotification));\n  }, [notification]);\n\n\n  return (\n    <SocketProvider>\n      <Suspense fallback={<AppLoader />}>\n        <Router>\n          <Switch>\n            {routes.map((route, idx) => (\n              <Authmiddleware\n                path={route.path}\n                layout={route.isAuth ? VerticalLayout : NonAuthLayout}\n                component={route.component}\n                key={idx}\n                isAuthProtected={route.isAuth ? true : false}\n                exact\n              />\n            ))}\n          </Switch>\n        </Router>\n      </Suspense>\n    </SocketProvider>\n  );\n};\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}