{"ast":null,"code":"/* eslint-disable quotes *//* eslint-disable object-property-newline */import React,{useEffect,useState}from\"react\";import{useTranslation}from\"react-i18next\";import{Button,Col}from\"reactstrap\";import{Field as FormikField}from\"formik\";import{CustomInput}from\"components/Common/CustomInput\";import{sendEmailPinAPI,verifyEmailPinAPI}from\"apis/register\";import _ from\"lodash\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function EmailPinField(props){const{t}=useTranslation();const[havePin,setHavePin]=useState(false);const[verifingPin,setVerifingPin]=useState(false);const[verifiedPin,setVerifiedPin]=useState(false);const[pinBtnText,setPinBtnText]=useState(t(\"Send PIN\"));const[storeEmaill,setStoreEmail]=useState();const{values,errors,setFieldTouched,setFieldValue,setFieldError,touched,isPinVerified,setIsPinVerified}=props;const sendPin=async()=>{setPinBtnText(t(\"Sending\"));setHavePin(true);setStoreEmail(values.email);setFieldTouched(\"emailPin\",true);const res=await sendEmailPinAPI({email:values.email.toLowerCase()});if(res.status){setHavePin(true);setPinBtnText(t(\"Enter PIN\"));}else{setHavePin(false);setPinBtnText(t(\"Send PIN\"));if(setFieldError)setFieldError(\"emailPin\",t(res));}};const verifyEmailPin=async(email,emailPin,errors,setFieldTouched)=>{setVerifingPin(true);setPinBtnText(t(\"Verifying\"));const resp=await verifyEmailPinAPI({email,emailPin});if(resp.status){setVerifingPin(false);setVerifiedPin(true);setPinBtnText(t(\"PIN Verified\"));setIsPinVerified(true);}else{setVerifingPin(false);setPinBtnText(t(\"Enter PIN\"));if(setFieldError)setFieldError(\"emailPin\",t(\"PIN must be verfied\"));setFieldTouched(t(\"emailPin\"));}};useEffect(()=>{if(_.isEqual(storeEmaill,values.email)===false){setHavePin(false);setPinBtnText(t(\"Send PIN\"));setFieldError(\"emailPin\",\"\");}else{setHavePin(true);setPinBtnText(t(\"Enter PIN\"));setFieldError(\"emailPin\",\"\");}},[values.email]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Col,{xs:12,className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(Button,{style:{border:\"1px solid #E4B200\",borderTopRightRadius:'0px',borderBottomRightRadius:'0px',borderTopLeftRadius:'24px',borderBottomLeftRadius:'24px',backgroundColor:\"#E4B200\"},disabled:havePin||errors.email||verifiedPin||verifingPin,onClick:sendPin,children:t(pinBtnText)})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow-1\",children:/*#__PURE__*/_jsx(FormikField,{component:CustomInput,name:\"emailPin\",className:\"mb-3\",style:{borderTopRightRadius:'24px',borderBottomRightRadius:'24px',borderTopLeftRadius:'0px',borderBottomLeftRadius:'0px',borderLeft:\"none\"},type:\"number\",min:0,placeholder:t(\"Enter Pin\"),disabled:!havePin||verifingPin||verifiedPin,invalid:false,onChange:e=>{var _e$target$value;if(((_e$target$value=e.target.value)===null||_e$target$value===void 0?void 0:_e$target$value.length)===4){verifyEmailPin(values.email,e.target.value,errors,setFieldTouched);}setFieldValue(\"emailPin\",e.target.value);}})})]}),errors.emailPin&&touched.emailPin&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 text-center text-danger\",children:t(errors.emailPin)}),havePin&&!isPinVerified&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 text-center text-danger\",children:t(\"PIN sent to your email, please verify\")}),havePin&&isPinVerified&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 text-center text-success\",children:t(\"PIN verified successfully\")})]});}export default EmailPinField;","map":{"version":3,"names":["React","useEffect","useState","useTranslation","Button","Col","Field","FormikField","CustomInput","sendEmailPinAPI","verifyEmailPinAPI","_","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","EmailPinField","props","t","havePin","setHavePin","verifingPin","setVerifingPin","verifiedPin","setVerifiedPin","pinBtnText","setPinBtnText","storeEmaill","setStoreEmail","values","errors","setFieldTouched","setFieldValue","setFieldError","touched","isPinVerified","setIsPinVerified","sendPin","email","res","toLowerCase","status","verifyEmailPin","emailPin","resp","isEqual","children","xs","className","style","border","borderTopRightRadius","borderBottomRightRadius","borderTopLeftRadius","borderBottomLeftRadius","backgroundColor","disabled","onClick","component","name","borderLeft","type","min","placeholder","invalid","onChange","e","_e$target$value","target","value","length"],"sources":["/home/ubuntu/Gowize-qa-pipline/client-portal-starter/src/components/Common/EmailPinField.js"],"sourcesContent":["/* eslint-disable quotes */\n/* eslint-disable object-property-newline */\nimport React, { useEffect, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Button, Col } from \"reactstrap\";\nimport {\n  Field as FormikField, \n} from \"formik\";\nimport { CustomInput } from \"components/Common/CustomInput\";\nimport { sendEmailPinAPI, verifyEmailPinAPI } from \"apis/register\";\nimport _ from \"lodash\";\n\nfunction EmailPinField(props) {\n  const { t } = useTranslation();\n  const [havePin, setHavePin] = useState(false);\n  const [verifingPin, setVerifingPin] = useState(false);\n  const [verifiedPin, setVerifiedPin] = useState(false);\n  const [pinBtnText, setPinBtnText] = useState(t(\"Send PIN\"));\n  const [storeEmaill, setStoreEmail] = useState();\n  const { values, errors, setFieldTouched, setFieldValue, setFieldError, touched, isPinVerified, setIsPinVerified } = props;\n\n  const sendPin = async () => {\n    setPinBtnText(t(\"Sending\"));\n    setHavePin(true);\n    setStoreEmail(values.email);\n    setFieldTouched(\"emailPin\", true);\n    const res = await sendEmailPinAPI({ email: values.email.toLowerCase() });\n    if (res.status) {\n      setHavePin(true);\n      setPinBtnText(t(\"Enter PIN\"));\n    } else {\n      setHavePin(false);\n      setPinBtnText(t(\"Send PIN\"));\n      if (setFieldError)\n        setFieldError(\"emailPin\", t(res));\n    }\n  };\n\n  const verifyEmailPin = async (email, emailPin, errors, setFieldTouched) => {\n    setVerifingPin(true);\n    setPinBtnText(t(\"Verifying\"));\n    const resp = await verifyEmailPinAPI({\n      email,\n      emailPin \n    });\n    if (resp.status) {\n      setVerifingPin(false);\n      setVerifiedPin(true);\n      setPinBtnText(t(\"PIN Verified\"));\n      setIsPinVerified(true);\n    } else {\n      setVerifingPin(false);\n      setPinBtnText(t(\"Enter PIN\"));\n      if (setFieldError)\n        setFieldError(\"emailPin\", t(\"PIN must be verfied\"));\n      setFieldTouched(t(\"emailPin\"));\n    } \n  };\n\n  useEffect(()=>{\n    if (_.isEqual(storeEmaill, values.email) === false ) {\n      setHavePin(false);\n      setPinBtnText(t(\"Send PIN\"));\n      setFieldError(\"emailPin\", \"\");\n    } else {\n      setHavePin(true);\n      setPinBtnText(t(\"Enter PIN\"));\n      setFieldError(\"emailPin\", \"\");\n    }\n  }, [values.email]);\n\n  return ( <>\n    <Col xs={12} className=\"d-flex align-items-center\">\n      <div className=\"mb-3\">\n        <Button style={{ border: \"1px solid #E4B200\", borderTopRightRadius: '0px',  borderBottomRightRadius: '0px', borderTopLeftRadius: '24px', borderBottomLeftRadius: '24px', backgroundColor: \"#E4B200\" }} disabled={havePin || errors.email || verifiedPin || verifingPin} onClick={sendPin}>\n          {t(pinBtnText)}\n        </Button>\n      </div>\n      <div className=\"flex-grow-1\">\n        <FormikField\n          component={CustomInput}\n          name=\"emailPin\"\n          className={\"mb-3\"}\n          style={{ \n            borderTopRightRadius: '24px',  borderBottomRightRadius: '24px',\n            borderTopLeftRadius: '0px', borderBottomLeftRadius: '0px',\n            borderLeft: \"none\"\n          }}\n          type={\"number\"}\n          min={0}\n          placeholder={t(\"Enter Pin\")}\n          disabled={!havePin || verifingPin || verifiedPin}\n          invalid={false}\n          onChange={(e)=>{\n            if (e.target.value?.length === 4){\n              verifyEmailPin(values.email, e.target.value, errors, setFieldTouched);\n            }\n            setFieldValue(\"emailPin\", e.target.value);\n          }}\n        >\n        </FormikField>\n      </div>\n    </Col>\n    {errors.emailPin && touched.emailPin && (\n      <div className=\"mb-4 text-center text-danger\">\n        {t(errors.emailPin)}\n      </div>\n    )}\n    {havePin && !isPinVerified && (\n      <div className=\"mb-4 text-center text-danger\">\n        {t(\"PIN sent to your email, please verify\")}\n      </div>\n    )}\n    {havePin && isPinVerified && ( \n      <div className=\"mb-4 text-center text-success\">\n        {t(\"PIN verified successfully\")}\n      </div>)}\n    {}\n  </> );\n}\n\nexport default EmailPinField;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}